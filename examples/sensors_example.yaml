# Voorbeeld: template sensor attributen voor testing
# Gebruik deze voorbeelden als basis om een template sensor in Home Assistant te maken.

template:
  - sensor:
      name: "Magister Agenda Vandaag en Morgen"
      state: "OK"
      availability: >
        {{ state_attr('sensor.magister_data', 'kinderen') is not none }}
      attributes:
        agenda: |
          {%- set data = state_attr('sensor.magister_data', 'kinderen') -%}
          {%- if not data -%}
          Geen data beschikbaar
          {%- else -%}

          {%- set vandaag = now().strftime('%Y-%m-%d') -%}
          {%- set morgen = (now() + timedelta(days=1)).strftime('%Y-%m-%d') -%}

          ðŸ“… **Vandaag ({{ now().strftime('%-d %B') }})**
          {%- for naam, info in data.items() %}
          **{{ naam }}**:
          {%- for a in info.afspraken | selectattr('start', 'search', vandaag) | sort(attribute='start') %}
            {{ a.start.split(' ')[1][:5] }} â€“ {{ a.einde.split(' ')[1][:5] }} | {{ a.omschrijving }}{% if a.is_huiswerk %} (huiswerk){% elif a.type == 'SO' %} (SO){% endif %}
          {%- else %}
            Geen afspraken vandaag
          {%- endfor %}
          {% endfor %}

          ðŸ“… **Morgen ({{ (now() + timedelta(days=1)).strftime('%-d %B') }})**
          {%- for naam, info in data.items() %}
          **{{ naam }}**:
          {%- for a in info.afspraken | selectattr('start', 'search', morgen) | sort(attribute='start') %}
            {{ a.start.split(' ')[1][:5] }} â€“ {{ a.einde.split(' ')[1][:5] }} | {{ a.omschrijving }}{% if a.is_huiswerk %} (huiswerk){% elif a.type == 'SO' %} (SO){% endif %}
          {%- else %}
            Geen afspraken morgen
          {%- endfor %}
          {% endfor %}

          {%- endif -%}
            - start: "2025-10-22T09:00:00"
              einde: "2025-10-22T10:00:00"
              omschrijving: "Wiskunde"
              lokaal: "A12"
            - start: "2025-10-22T10:15:00"
              einde: "2025-10-22T11:00:00"
              omschrijving: "Nederlands"
              lokaal: "B01"
          volgende_afspraak: "09:00"
          volgende_vak: "WISKUNDE"
          absenties: []
          wijzigingen: []
          aanmeldingen: []
          activiteiten: []
